/*!
 *
 * Bryntum Scheduler Pro 5.3.7
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
var h=Object.defineProperty;var b=(a,t,e)=>t in a?h(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var p=(a,t,e)=>(b(a,typeof t!="symbol"?t+"":t,e),e);import{ColumnStore as x,Column as S,GridFeatureManager as C}from"./GridBase.js";import{NumberFormat as G}from"./MessageDialog.js";import{ObjectHelper as M,InstancePlugin as E,EventHelper as W}from"./Editor.js";class d extends S{static get defaults(){return{filterType:"number",format:""}}get defaultEditor(){const{format:t,name:e,max:i,min:n,step:r,largeStep:o,align:l}=this;return M.cleanupProperties({type:"numberfield",format:t,name:e,max:i,min:n,step:r,largeStep:o,textAlign:l})}get formatter(){const t=this,{format:e}=t;let i=t._formatter;return(!i||t._lastFormat!==e)&&(t._formatter=i=G.get(t._lastFormat=e)),i}formatValue(t){return t!=null&&(t=this.formatter.format(t),this.unit&&(t=`${t}${this.unit}`)),t!=null?t:""}defaultRenderer({value:t}){return this.formatValue(t)}}p(d,"type","number"),p(d,"fieldType","number"),p(d,"fields",["format","min","max","step","largeStep","unit"]),x.registerColumnType(d,!0),d.exposeProperties(),d._$name="NumberColumn";class c extends E{static get pluginConfig(){return{chain:["onElementPointerDown","onElementDblClick","onElementTouchMove","onSubGridCollapse","onSubGridExpand","render"]}}onElementDblClick(t){const e=this,{client:i}=e,n=t.target.closest(".b-grid-splitter-collapsed");if(n&&!e.expanding){e.expanding=!0;let r=n.dataset.region,o=i.getSubGrid(r);o.collapsed||(r=i.getLastRegions()[1],o=i.getSubGrid(r)),o.expand().then(()=>e.expanding=!1)}}startMove(t,e){const i=this,{client:n}=i,r=t.dataset.region,o=n.element,l=n.regions[n.regions.indexOf(r)+1],g=n.getSubGrid(l),f=n.getSubGrid(r);let s=f,u=1;if(s.flex!=null&&g.flex==null&&(s=g,u=-1),n.rtl&&(u*=-1),t.classList.contains("b-grid-splitter-collapsed"))return;const m=s.element.offsetWidth+g.element.offsetWidth;i.dragContext={element:t,headerEl:s.header.element,subGridEl:s.element,subGrid:s,splitterSubGrid:f,originalWidth:s.element.offsetWidth,originalX:e,minWidth:s.minWidth||0,maxWidth:Math.min(m,s.maxWidth||m),flip:u},o.classList.add("b-moving-splitter"),f.toggleSplitterCls("b-moving"),i.pointerDetacher=W.on({element:document,pointermove:"onPointerMove",pointerup:"onPointerUp",thisObj:i})}endMove(){const t=this,{dragContext:e}=t;e&&(t.pointerDetacher(),t.client.element.classList.remove("b-moving-splitter"),e.splitterSubGrid.toggleSplitterCls("b-moving",!1),t.dragContext=null)}onCollapseClick(t,e,i){const n=this,{client:r}=n,o=e.dataset.region,l=r.getLastRegions();if(r.trigger("splitterCollapseClick",{subGrid:t,domEvent:i})!==!1){if(l[0]===o){const g=r.getSubGrid(l[1]);if(g.collapsed){g.expand();return}}t.collapse()}}onExpandClick(t,e,i){const n=this,{client:r}=n,o=e.dataset.region,l=r.getLastRegions();if(r.trigger("splitterExpandClick",{subGrid:t,domEvent:i})!==!1){if(l[0]===o&&!t.collapsed){r.getSubGrid(l[1]).collapse();return}t.expand()}}updateMove(t){const{dragContext:e}=this;if(e){const i=t-e.originalX,n=Math.max(Math.min(e.maxWidth,e.originalWidth+i*e.flip),0);e.subGrid.width=Math.max(n,e.minWidth)}}onElementPointerDown(t){const e=this,{target:i}=t,n=t.button===0&&i.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),r=n&&e.client.getSubGrid(n.dataset.region);let o;n&&(i.closest(".b-grid-splitter-button-collapse")?e.onCollapseClick(r,n,t):i.closest(".b-grid-splitter-button-expand")?e.onExpandClick(r,n,t):(e.startMove(n,t.clientX),o=n)),t.pointerType==="touch"&&e.toggleTouchSplitter(o)}onPointerMove(t){this.dragContext&&(this.updateMove(t.clientX),t.preventDefault())}onElementTouchMove(t){this.dragContext&&t.preventDefault()}onPointerUp(t){this.dragContext&&(this.endMove(),t.preventDefault())}onSubGridCollapse({subGrid:t}){const e=this.client.resolveSplitter(t);this.client.getLastRegions()[1]===t.region&&e.classList.add("b-grid-splitter-allow-collapse")}onSubGridExpand({subGrid:t}){this.client.resolveSplitter(t).classList.remove("b-grid-splitter-allow-collapse")}toggleTouchSplitter(t){const e=this,{touchedSplitter:i}=e;t&&i&&t.dataset.region!==i.dataset.region&&e.toggleTouchSplitter();const n=e.client.getSubGrid(t?t.dataset.region:i==null?void 0:i.dataset.region);n&&(n.toggleSplitterCls("b-touching",!!t),t?n.startSplitterButtonSyncing():n.stopSplitterButtonSyncing()),e.touchedSplitter=t}render(){const{regions:t,subGrids:e}=this.client;t.length>2&&(e[t[0]].splitterElement.classList.add("b-left-only"),e[t[1]].splitterElement.classList.add("b-right-only"))}}p(c,"$name","RegionResize"),c.featureClass="b-split",c._$name="RegionResize",C.registerFeature(c);export{d as NumberColumn,c as RegionResize};
//# sourceMappingURL=RegionResize.js.map
