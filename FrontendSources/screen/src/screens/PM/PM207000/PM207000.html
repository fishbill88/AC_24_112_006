<template>
	<qp-template name="1-2" id="Billing_form" wg-container>
		<qp-fieldset slot="A" id="form" view.bind="Billing">
			<field name="BillingID" >
				<qp-field control-state.bind="Billing.IsActive" class="col-4">
				</qp-field>
			</field>
			<field name="Description" config-type.bind="1" config-rows.bind="3"></field>
		</qp-fieldset>
	</qp-template>
	<qp-template name="1-2" id="BillingRulesForm">
		<div slot="A" id="BillingRulesGrid">
			<qp-grid id="grid" view.bind="BillingRules" class="framed-section">
			</qp-grid>
		</div>
		<div slot="B" id="BillingRule_formRules" wg-container>
			<qp-template name="1-1" id="TypeAndAccountGroupIDForm" class="label-size-m">
				<div slot="A">
					<qp-fieldset id="formRulesType" view.bind="BillingRule">
						<field name="Type" ></field>
					</qp-fieldset>
					<qp-fieldset id="formRulesAccountGroupID" view.bind="BillingRule" caption="Transaction Selection Criteria">
						<field name="AccountGroupID" ></field>
					</qp-fieldset>
				</div>
			</qp-template>

			<qp-template name="1-1" id="RateTypeIDAndNoRateOptionForm">
				<qp-fieldset slot="A" id="formRulesRateTypeID" view.bind="BillingRule" class="label-size-m">
					<field name="RateTypeID" ></field>
				</qp-fieldset>
				<qp-fieldset slot="B" id="formRulesNoRateOption" view.bind="BillingRule" class="label-size-sm">
					<field name="NoRateOption" ></field>
				</qp-fieldset>
			</qp-template>

			<qp-template name="1" id="FormulasForm" class="label-size-m">
				<qp-fieldset slot="A" id="formRulesFormulas" view.bind="BillingRule" caption="Invoice Settings">
					<field name="InvoiceFormula"
						control-type="qp-formula-editor"
						config-parameters.bind="true"
						config-application-functions.bind="['ConvertAmountToCurrency(fromCuryID, toCuryID, rateType, effectiveDate, value)']"
						config-application-functions-append.bind="true"
						config-dynamic-fields.bind="['PMAccountGroup', 'PMBudget', 'PMProject', 'PMTask', 'PMTran', 'Customer', 'EPEmployee', 'InventoryItem', 'Vendor']"
						config-dynamic-node-name.bind="'Objects'"
						config-preload-dynamic-node.bind="true">
					</field>
					<field name="QtyFormula"
						control-type="qp-formula-editor"
						config-parameters.bind="true"
						config-application-functions.bind="['ConvertAmountToCurrency(fromCuryID, toCuryID, rateType, effectiveDate, value)']"
						config-application-functions-append.bind="true"
						config-dynamic-fields.bind="['PMAccountGroup', 'PMBudget', 'PMProject', 'PMTask', 'PMTran', 'Customer', 'EPEmployee', 'InventoryItem', 'Vendor']"
						config-dynamic-node-name.bind="'Objects'"
						config-preload-dynamic-node.bind="true">
					</field>
					<field name="AmountFormula"
						control-type="qp-formula-editor"
						config-parameters.bind="true"
						config-application-functions.bind="['ConvertAmountToCurrency(fromCuryID, toCuryID, rateType, effectiveDate, value)']"
						config-application-functions-append.bind="true"
						config-dynamic-fields.bind="['PMAccountGroup', 'PMBudget', 'PMProject', 'PMTask', 'PMTran', 'Customer', 'EPEmployee', 'InventoryItem', 'Vendor']"
						config-dynamic-node-name.bind="'Objects'"
						config-preload-dynamic-node.bind="true">
					</field>
					<field name="DescriptionFormula"
						control-type="qp-formula-editor"
						config-parameters.bind="true"
						config-application-functions.bind="['ConvertAmountToCurrency(fromCuryID, toCuryID, rateType, effectiveDate, value)']"
						config-application-functions-append.bind="true"
						config-dynamic-fields.bind="['PMAccountGroup', 'PMBudget', 'PMProject', 'PMTask', 'PMTran', 'Customer', 'EPEmployee', 'InventoryItem', 'Vendor']"
						config-dynamic-node-name.bind="'Objects'"
						config-preload-dynamic-node.bind="true">
					</field>
				</qp-fieldset>
			</qp-template>

			<qp-template name="1-1" id="InvoiceSettingsForm">
				<qp-fieldset slot="A" id="formRulesSourceInvoiceSettings" view.bind="BillingRule" class="label-size-m">
					<field name="BranchSource" ></field>
					<field name="BranchSourceBudget" ></field>
					<field name="AccountSource" ></field>
					<field name="SubMask" ></field>
					<field name="SubMaskBudget" ></field>
				</qp-fieldset>

				<qp-fieldset slot="B" id="formRulesTargetInvoiceSettings" view.bind="BillingRule" class="label-size-sm">
					<field name="TargetBranchID" ></field>
					<field name="AccountID" ></field>
					<field name="SubID" ></field>
				</qp-fieldset>
			</qp-template>

			<qp-template name="1" id="BillingOptionsForm" class="label-size-m">
				<qp-fieldset slot="A" id="formRulesBillingOptions" view.bind="BillingRule" caption="Billing Options">
					<field name="BillingOptionsFields01" unbound>
						<qp-field control-state.bind="BillingRule.CopyNotes" class="col-sm-12 col-md-12 col-lg-6">
						</qp-field>
						<qp-field control-state.bind="BillingRule.IncludeZeroAmountAndQty" class="col-sm-12 col-md-12 col-lg-6">
						</qp-field>
					</field>
					<field name="BillingOptionsFields02" unbound>
						<qp-field control-state.bind="BillingRule.IncludeNonBillable" class="col-sm-12 col-md-12 col-lg-6">
						</qp-field>
						<qp-field control-state.bind="BillingRule.IncludeZeroAmount" class="col-sm-12 col-md-12 col-lg-6">
						</qp-field>
					</field>
				</qp-fieldset>
			</qp-template>

			<qp-template name="1" id="AggregateTransactionsByForm" class="label-size-m" if.bind="BillingRule.Type.value != 'B'">
				<qp-fieldset slot="A" id="formRulesAggregateTransactionsBy" view.bind="BillingRule" caption="Aggregate Transactions By">
					<field name="AggregateTransactionsByFields" unbound>
						<qp-field control-state.bind="BillingRule.GroupByDate" class="col-sm-12 col-md-6 col-lg-3">
						</qp-field>
						<qp-field control-state.bind="BillingRule.GroupByEmployee" class="col-sm-12 col-md-6 col-lg-3">
						</qp-field>
						<qp-field control-state.bind="BillingRule.GroupByVendor" class="col-sm-12 col-md-6 col-lg-3">
						</qp-field>
						<qp-field control-state.bind="BillingRule.GroupByItem" class="col-sm-12 col-md-6 col-lg-3">
						</qp-field>
					</field>
				</qp-fieldset>
			</qp-template>
		</div>
	</qp-template>
</template>
